<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Stock por sucursal</title>
<style>
table { border-collapse: collapse; width: 100%; }
td, th { border: 1px solid #ccc; padding: 6px; text-align: center; }
input { width: 70px; }
button { padding: 10px 20px; margin-top: 10px; }
</style>
</head>
<body>

<h2>Cama Luton – Individual / Gris</h2>

<table id="tabla">
  <thead>
    <tr>
      <th>Sucursal</th>
      <th>Stock actual</th>
      <th>Nuevo</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<button onclick="guardar()">Guardar cambios</button>

<script>
const HANDLE = 'cama-luton';

const OPCIONES = [
  { nombre: 'Tamaño', valor: 'Individual' },
  { nombre: 'Color', valor: 'Gris' }
];

const DATA = {
  sucursales: [
    "WEB","Suc. Centro","Suc. Coyoacán","Suc. Benito Juárez",
    "Suc. Gustavo Baz","Suc. Naucalpan","Suc. Toluca",
    "Suc. Querétaro","Suc. Vallejo","Suc. Puebla"
  ],
  cantidades: [10,5,5,99,5,5,5,5,5,5]
};

const tbody = document.querySelector('#tabla tbody');

DATA.sucursales.forEach((suc, i) => {
  const tr = document.createElement('tr');
  tr.innerHTML = `
    <td>${suc}</td>
    <td>${DATA.cantidades[i]}</td>
    <td><input data-suc="${suc}" placeholder="="></td>
  `;
  tbody.appendChild(tr);
});

async function guardar() {
  const cambios = {};
  document.querySelectorAll('input').forEach(i => {
    if (i.value !== '') cambios[i.dataset.suc] = i.value;
  });

  const r = await fetch('/api/metafield', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      handle: HANDLE,
      opciones: OPCIONES,
      cambios
    })
  });

  const j = await r.json();
  alert(j.ok ? '✔ Guardado' : '✗ Error');
}
</script>

</body>
</html>
